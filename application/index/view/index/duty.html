<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <title>{$headerTitle}</title>
    <script type="text/javascript" src="__STATIC__/index/js/jquery.js"></script>
    <style type="text/css">

        *{
            margin: 0;
            padding: 0;
        }
        body{
            font-size: 14px;
        }
        a{
            text-decoration: none;
            cursor: pointer;
        }
        li{
            list-style: none;
        }
        /*头部区域*/
        .header{
            width: 100%;
            height: 50px;
            background: black;
            position: relative;

        }
        .header a{
            position: absolute;
            top: 0;
            right: 5px;
            display: block;
            width: 80px;
            height: 50px;
            line-height: 50px;
            color: white;
        }
        /*头部区域结束*/
        /*主体区域*/
        .box{
            margin: 20px auto;
        }
        /*标题区域*/
        .box h1{
            margin: 0 auto;
            text-align: center;
        }
        /*标题区域结束*/
        /*色块提示区域*/
        .box .notice{
            margin: 0 auto;
            margin-top: 20px;
            margin-bottom: 10px;
            width: 1300px;
            height: 20px;
            position: relative;
        }
        .box .notice .notice-box{
            width: 400px;
            height: 20px;
            margin: 0 auto;
        }
        .box .notice p{
            float: left;
            margin-right: 10px;
        }
        .box .notice p span{
            display: block;
            float: left;
            height: 20px;
        }
        .box .notice p .explain{
            line-height: 20px;
            text-align: right;
            width: 60px;
        }
        .box .notice p .color{
            height:20px;
            width: 30px;
        }
        .box .notice .nav-box{
            position: absolute;
            right: 220px;
            top: 0;
        }
        .box .notice .nav-box .nav-btn{
            display: inline-block;
            width: 100px;
            height: 20px;
            text-align: center;
            line-height: 20px;
            background: #343a40;
            color: white;
            cursor: pointer;
        }
        .box .notice .nav-box .nav-btn:hover{
            opacity: 0.8;
        }
        .box .notice .date-box{
            position: absolute;
            right: 30px;
            top: 0;
        }
        .box .notice .date-box .confirm{
            display: inline-block;
            width: 50px;
            height: 20px;
            text-align: center;
            line-height: 20px;
            background: #343a40;
            color: white;
            cursor: pointer;
        }
        .box .notice .date-box a:hover{
            opacity: 0.8;
        }
        /*色块提示区域结束*/
        /*表格头部区域*/
        .box .header{
            width: 1300px;
            height: 50px;
            background: none;
            margin: 0 auto;
            border: 1px solid black;
            border-bottom: none;
            text-align: center;
            line-height: 50px;
            font-weight: 600;
        }
        .box .header .name{
            border-right: 1px solid black;
            width: 89px;
            height: 50px;
            float: left;
            position: relative;
        }
        .box .header .duty{
            border-right: 1px solid black;
            width: 414px;
            height: 50px;
            float: left;
            position: relative;
        }
        .box .header .duty .duty-header-text{
            position: absolute;
            width: 100%;
            text-align: center;
            left:0;
            top:50%;
            transform: translate(0,-50%);
            cursor: pointer;
        }
        .box .header .duty .duty-header-select{
            position: absolute;
            text-align: center;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            display: none;
        }
        .box .header .num{
            border-right: 1px solid black;
            width: 49px;
            height: 50px;
            float: left;
        }
        .box .header .process{
            width: 650px;
            height: 50px;
            float: left;
        }
        .box .header .status{
            border-left: 1px solid black;
            width: 94px;
            height: 50px;
            float: left;
            position: relative;
        }
        .box .header .status .status-header-text{
            position: absolute;
            width: 100%;
            text-align: center;
            left:0;
            top:50%;
            transform: translate(0,-50%);
            cursor: pointer;
        }
        .box .header .status .status-header-select{
            position: absolute;
            text-align: center;
            left:50%;
            top: 50%;
            transform: translate(-50%,-50%);
            display: none;
        }
        /*表格头部区域结束*/
        /*表格主体区域*/
        .box ul{
            width:  1300px;
            border-left:1px solid black;
            border-right: 1px solid black;
            padding: 0;
            margin: 0 auto;
        }
        .box ul li{
            width: 1300px;
            height: 106px;
            border-top: 1px solid black;
            border-bottom: 1px solid black;
            margin-bottom:15px;
            position: relative;
        }
        .box ul li:last-of-type{
            margin-bottom: 0px;
        }
        .box .ul .li .name{
            float: left;
            width: 89px;
            border-right: 1px solid black;
            height: 106px;
            position: relative;
        }
        .box .ul .li .name .name-text{
            position: absolute;
            top:0;
            left: 0;
            width: 100%;
            text-align: center;
        }
        .box .ul .li .duty{
            float: left;
            width: 414px;
            border-right: 1px solid black;
            height: 106px;
            position: relative;
        }
        .box .ul .li .duty .duty-header{
            position: absolute;
            left: 0;
            top: 0;
            width: 414px;
            height: 61px;
            text-align: center;
            line-height: 61px;
            font-weight: 700;
        }
        .box .ul .li .duty .duty-header .duty-every-header-text{
            position: absolute;
            width: 100%;
            text-align: center;
            left:0;
            top:50%;
            transform: translate(0,-50%);
            cursor: pointer;
        }
        .box .ul .li .duty .duty-header .duty-every-header-select{
            position: absolute;
            text-align: center;
            left: 50%;
            top: 50%;
            transform: translate(-50%,-50%);
            display: none;
        }
        .box .ul .li .duty .duty-box {
            position: absolute;
            width: 414px;
            top:60px;
            left: 0;
            height: 45px;
            border-top: 1px solid black;
        }
        .box .ul .li .duty .duty-box .duty-every{
            border-bottom: 1px solid black;
            width: 414px;
            height: 35px;
            text-align: center;
            margin-top: 8px;
            border-top: 1px solid black;
            position: relative;
        }
        .box .ul .li .duty .duty-box .duty-every .duty-text{
            width: 100%;
            position: absolute;
            top: 8px;
            left:0;
            /*transform: translate(0,-50%);*/
            text-align: center;
            cursor: pointer;
        }
        .box .ul .li .duty .duty-box .duty-every .duty-text a{
            color: black;
        }
        .box .ul .li .duty .duty-box .duty-every .duty-text .duty-content{
            position: absolute;
            top: 0;
            right:-352px;
            background: #343a40;
            width: 350px;
            padding-top: 0;
            padding-bottom: 0;
            color: white;
            border-left: 1px solid black;
            border-right: 1px solid black;
            border-bottom: 1px solid black;
            display: none;
        }
        .box .ul .li .duty .duty-box .duty-every .duty-text .duty-content .content{
            width: 345px;
            padding-top: 5px;
            padding-bottom: 5px;
            margin-left: 5px;
            text-align: left;
            line-height:normal;
        }
        .box .ul .li .duty .duty-box .duty-every .duty-text .enter{
            display: block;
            z-index: 99999;
        }
        .box .ul .li .duty .duty-box .duty-every .url{
            cursor: pointer;
            color: darkblue;
            text-decoration: none;
        }
        .box .ul .li .duty duty-box .duty-every .url:hover{
            opacity: 0.9;
        }
        .box .ul .li .num{
            float: left;
            width: 49px;
            border-right: 1px solid black;
            height: 106px;
            position: relative;
        }
        .box .ul .li .num .num-header{
            position: absolute;
            left: 0;
            top: 0;
            width: 49px;
            height: 61px;
            text-align: center;
            line-height: 61px;
            font-weight: 700;
        }
        .box .ul .li .num .num-box{
            position: absolute;
            width: 49px;
            top:60px;
            left: 0;
            height: 45px;
            border-top: 1px solid black;
        }
        .box .ul .li .num .num-box .num-every{
            border-bottom: 1px solid black;
            width: 49px;
            height: 35px;
            text-align: center;
            line-height: 35px;
            margin-top: 8px;
            border-top: 1px solid black;
        }
        .box .ul .li .process{
            float: left;
            width: 650px;
            height: 106px;
            position: relative;
        }
        .box .ul .li .process .timetable{
            width: 650px;
            height: 61px;
            position: absolute;
            top: 0;
            left: 50%;
            transform: translate(-50%,0);
            z-index: 999;
        }
        .box .ul .li .process .timetable .day-box{
            width: 650px;
            height:29px;
            border-bottom: 1px solid black;
        }
        .box .ul .li .process .timetable .day-box .day{
            height: 29px;
            width: 20px;
            border-right: 1px solid black;
            text-align: center;
            line-height: 29px;
            float: left;
            background: #b3bdb7;
            color: white;
        }
        .box .ul .li .process .timetable .week-box{
            width: 650px;
            height: 30px;
            border-bottom: 1px solid black;
        }
        .box .ul .li .process .timetable .week-box .week{
            height: 30px;
            width: 20px;
            border-right: 1px solid black;
            text-align: center;
            line-height: 30px;
            float: left;
            background: #b3bdb7;
            color: white;
        }
        .box .ul .li .process .process-box{
            position: absolute;
            top: 61px;
            left: 50%;
            transform: translate(-50%,0);
            width: 650px;
            height: 45px;
        }
        .box .ul .li .process .process-box .td{
            width: 20px;
            height: 45px;
            border-right: 1px solid black;
            float: left;
        }
        .box .ul .li .process .line{
            display: none;
            width: 1px;
            height: 45px;
            position: absolute;
            top: 61px;
            background: black;
        }
        .box .ul .li .process .time-outbox{
            position: absolute;
            top:61px;
            left: 50%;
            transform: translate(-50%,0);
        }
        .box .ul .li .process .time-box{
            width: 650px;
            height: 35px;
            border-top: 1px solid black;
            border-bottom: 1px solid black;
            margin-top: 8px;
            position: relative;
        }
        .box .ul .li .process .time-box .time{
            height: 35px;
            width: 104px;
            position: absolute;
            top: 0;
            left: 147px;
        }
        .box .ul .li .process .time-box .time .time-right{
            height: 35px;
            width: 5px;
            background: red;
            position: absolute;
            top: 0;
            right: 0;
            opacity: 0;
        }
        .box .ul .li .process .time-box .time .time-left{
            height: 35px;
            width: 5px;
            background: red;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
        }
        .box .ul .li .status{
            float: left;
            width: 94px;
            border-left: 1px solid black;
            height: 106px;
            position: relative;
        }
        .box .ul .li .status .status-header{
            position: absolute;
            left: 0;
            top: 0;
            width: 94px;
            height: 61px;
            text-align: center;
            line-height: 61px;
            font-weight: 700;
        }
        .box .ul .li .status .status-header .status-every-header-text{
            position: absolute;
            width: 100%;
            text-align: center;
            left:0;
            top:50%;
            transform: translate(0,-50%);
            cursor: pointer;
        }
        .box .ul .li .status .status-header .status-every-header-select{
            position: absolute;
            text-align: center;
            left:50%;
            top: 50%;
            transform: translate(-50%,-50%);
            display: none;
        }
        .box .ul .li .status .status-box {
            position: absolute;
            width: 94px;
            top:60px;
            left: 0;
            height: 45px;
            border-top: 1px solid black;
        }
        .box .ul .li .status .status-box .status-every{
            border-bottom: 1px solid black;
            width: 94px;
            height: 35px;
            text-align: center;
            line-height: 35px;
            margin-top: 8px;
            border-top: 1px solid black;
            position: relative;
        }
        .box .ul .li .status .status-box .status-every .btn{
            display: block;
            height: 20px;
            width: 60px;
            position: absolute;
            top: 7px;
            left: 17px;
            background: #343a40;
            color: white;
            text-align: center;
            line-height: 20px;
            cursor: pointer;
        }
        .box .ul .li .status .status-box .status-every .btn:hover{
            opacity: 0.8;
        }
        /*表格主体区域结束*/
        .green{
            background: green;
        }
        .gray{
            background: #cccccc;
        }
        .pink{
            background: pink;
        }
        .orange{
            background: orangered;
        }
        .yellow{
            background:yellow;
        }
        .blue{
            background: blue;
        }
        .important-unfinish{
            display: block;
        }
        .important-finish{
            display: none;
        }
        .usual-unfinish{
            display:  none;
        }
        .usual-finish {
            display:  none;
        }
        /*主体区域结束*/
        /*楼层按钮*/
        .lou-btn{
            display: none;
            position: fixed;
            left: 2px;
            top: 300px;
            width: 15px;
            padding-top: 5px;
            padding-bottom: 5px;
            background: #343a40;
            color: white;
        }
        .lou-btn:hover{
            opacity: 0.8;
        }
        .lou-box{
            position: fixed;
            left: 2px;
            top: 30px;
            border-left: 1px solid black;
            border-right: 1px solid black;
            display: none;
        }
        .lou-box .lou{
            display: block;
            width: 50px;
            height: 35px;
            margin-bottom: 2px;
            background: #343a40;
            color: white;
            text-align: center;
            line-height: 35px;
        }
        .lou-box .lou:last-of-type{
            margin-bottom: 0px;
        }
        .lou-box .lou:hover{
            opacity: 0.8;
        }
        /*楼层按钮结束*/
    </style>
    <script type="text/javascript">
        $(function () {
            //设置任务名称文本高度居中
            function dutycenter() {
                $('.duty-text').each(function () {
                    var jqthis=$(this);
                    if(jqthis.height()!==0){
                        var text_height=jqthis.height();
                        var text_top=(35-text_height)/2;
                        jqthis.css({'top':text_top+'px'});
                    }
                })
            }
            dutycenter();
            //设置任务名称文本高度居中结束

            //每个人的计划按重要程度和状态的value显示
            function display() {
                var li_length=$('li').length;
                for(var i=0;i<li_length;i++){
                    var dutyimportance_val=$('li').eq(i).find('.duty-every-header-select').val();
                    var dutyfinish_val=$('li').eq(i).find('.status-every-header-select').val();
                    console.log('重要程度'+dutyimportance_val);
                    console.log('状态'+dutyfinish_val);
                    if(dutyimportance_val==1){
                        if(dutyfinish_val==0){
                            $('li').eq(i).find('.usual-unfinish').hide();
                            $('li').eq(i).find('.important-unfinish').show();
                            $('li').eq(i).find('.important-finish').hide();
                            $('li').eq(i).find('.usual-finish').hide();
                            $('li').eq(i).find('.status-every-header-text').text('未完成任务');
                        }else if(dutyfinish_val==1){
                            $('li').eq(i).find('.usual-unfinish').hide();
                            $('li').eq(i).find('.important-unfinish').hide();
                            $('li').eq(i).find('.important-finish').show();
                            $('li').eq(i).find('.usual-finish').hide();
                            $('li').eq(i).find('.status-every-header-text').text('已完成任务');
                        }else if(dutyfinish_val==2){
                            $('li').eq(i).find('.usual-unfinish').hide();
                            $('li').eq(i).find('.important-unfinish').show();
                            $('li').eq(i).find('.important-finish').show();
                            $('li').eq(i).find('.usual-finish').hide();
                            $('li').eq(i).find('.status-every-header-text').text('全部任务');
                        }
                        $('li').eq(i).find('.duty-every-header-text').text('重要任务');
                    }else if(dutyimportance_val==0){
                        if(dutyfinish_val==0){
                            $('li').eq(i).find('.usual-unfinish').show();
                            $('li').eq(i).find('.important-unfinish').hide();
                            $('li').eq(i).find('.important-finish').hide();
                            $('li').eq(i).find('.usual-finish').hide();
                            $('li').eq(i).find('.status-every-header-text').text('未完成任务');
                        }else if(dutyfinish_val==1){
                            $('li').eq(i).find('.usual-unfinish').hide();
                            $('li').eq(i).find('.important-unfinish').hide();
                            $('li').eq(i).find('.important-finish').hide();
                            $('li').eq(i).find('.usual-finish').show();
                            $('li').eq(i).find('.status-every-header-text').text('已完成任务');
                        }else if(dutyfinish_val==2){
                            $('li').eq(i).find('.usual-unfinish').show();
                            $('li').eq(i).find('.important-unfinish').hide();
                            $('li').eq(i).find('.important-finish').hide();
                            $('li').eq(i).find('.usual-finish').show();
                            $('li').eq(i).find('.status-every-header-text').text('全部任务');
                        }
                        $('li').eq(i).find('.duty-every-header-text').text('一般任务');
                    }else if(dutyimportance_val==3){
                        if(dutyfinish_val==0){
                            $('li').eq(i).find('.usual-unfinish').show();
                            $('li').eq(i).find('.important-unfinish').show();
                            $('li').eq(i).find('.important-finish').hide();
                            $('li').eq(i).find('.usual-finish').hide();
                            $('li').eq(i).find('.status-every-header-text').text('未完成任务');
                        }else if(dutyfinish_val==1){
                            $('li').eq(i).find('.usual-unfinish').hide();
                            $('li').eq(i).find('.important-unfinish').hide();
                            $('li').eq(i).find('.important-finish').show();
                            $('li').eq(i).find('.usual-finish').show();
                            $('li').eq(i).find('.status-every-header-text').text('已完成任务');
                        }else if(dutyfinish_val==2){
                            $('li').eq(i).find('.usual-unfinish').show();
                            $('li').eq(i).find('.important-unfinish').show();
                            $('li').eq(i).find('.important-finish').show();
                            $('li').eq(i).find('.usual-finish').show();
                            $('li').eq(i).find('.status-every-header-text').text('全部任务');
                        }
                        $('li').eq(i).find('.duty-every-header-text').text('全部任务');
                    }
                }
            }
            display();
            //每个人的计划按重要程度和状态的value显示结束

            //设置li和li里面的元素的高度
            function liheight() {
                var length=$('li').length;
                var ul_height=0;
                for(var j=0;j<length;j++){
                    var time_num=0;
                    for(var m=0;m<$('li').eq(j).find('.time-box').length;m++){
                        var display=$('li').eq(j).find('.time-box').eq(m).css('display');
                        if(display=='block'){
                            time_num=time_num+1;
                        }
                    }
                    //console.log('任务数量'+time_num);
                    if(time_num>0) {
                        var box_height = 45 * time_num;
                        var li_height = box_height + 61 + 8;
                        $('li').eq(j).css({'height': li_height+ 'px'});
                        $('li').eq(j).find('.name').css({'height':li_height+'px'});
                        $('li').eq(j).find('.name').css({'line-height':li_height+'px'});
                        //$('li').eq(j).find('.name').css({'borderBottom':'1px solid black'});
                        $('li').eq(j).find('.duty').css({'height': li_height + 'px'});
                        $('li').eq(j).find('.title').css({'height': li_height + 'px'});
                        $('li').eq(j).find('.num').css({'height': li_height + 'px'});
                        //$('li').eq(j).find('.rate').css({'height': li_height + 'px'});
                        $('li').eq(j).find('.process').css({'height': li_height + 'px'});
                        $('li').eq(j).find('.status').css({'height': li_height + 'px'});
                        $('li').eq(j).find('.title-box').css({'height': box_height + 'px'});
                        $('li').eq(j).find('.duty-box').css({'height': box_height + 'px'});
                        $('li').eq(j).find('.num-box').css({'height': box_height + 'px'});
                        //$('li').eq(j).find('.rate-box').css({'height': box_height + 'px'});
                        $('li').eq(j).find('.process-box').css({'height': box_height + 'px'});
                        $('li').eq(j).find('.line').css({'height': box_height + 'px'});
                        $('li').eq(j).find('.time-outbox').css({'height': box_height + 'px'});
                        $('li').eq(j).find('.status-box').css({'height': box_height + 'px'});
                        $('li').eq(j).find('.td').css({'height': box_height + 'px'});
                    }else{
                        $('li').eq(j).css({'height': '106px'});
                        $('li').eq(j).find('.name').css({'height':'106px'});
                        $('li').eq(j).find('.name').css({'line-height':106+'px'});
                        //$('li').eq(j).find('.name').css({'borderBottom':'1px solid black'});
                        $('li').eq(j).find('.duty').css({'height': '106px'});
                        $('li').eq(j).find('.title').css({'height': '106px'});
                        $('li').eq(j).find('.num').css({'height': '106px'});
                        //$('li').eq(j).find('.rate').css({'height': '106px'});
                        $('li').eq(j).find('.process').css({'height': '106px'});
                        $('li').eq(j).find('.status').css({'height': '106px'});
                        $('li').eq(j).find('.title-box').css({'height': '45px'});
                        $('li').eq(j).find('.duty-box').css({'height': '45px'});
                        $('li').eq(j).find('.num-box').css({'height': '45px'});
                        //$('li').eq(j).find('.rate-box').css({'height': '45px'});
                        $('li').eq(j).find('.process-box').css({'height': '45px'});
                        $('li').eq(j).find('.line').css({'height': '45px'});
                        $('li').eq(j).find('.time-outbox').css({'height': '45px'});
                        $('li').eq(j).find('.status-box').css({'height': '45px'});
                        $('li').eq(j).find('.td').css({'height': '45px'});
                    }
                    ul_height=($('li').eq(j).height()+2)+ul_height;
                }
                //设置ul的高度
                ul_height=ul_height+15*(length-1);
                $('ul').css({'height':ul_height+'px'});
                //设置ul的高度结束
            }
            liheight();
            //设置li和li里面的元素的高度结束

            //除管理员外，按每一个的计划数量排序
            function liorder() {
                var li_length = $('li').length;
                for (var b=1;b<li_length;b++){
                    for(var c=1;c<li_length-1;c++){
                        var num=0;
                        var timebox_long=$('li').eq(c).find('.time-box').length;
                        for(var d=0;d<timebox_long;d++){
                            var display=$('li').eq(c).find('.time-box').eq(d).css('display');
                            if(display=='block'){
                                num=num+1;
                            }
                        }
                        var next_num=0;
                        var timebox_long=$('li').eq(c+1).find('.time-box').length;
                        for(var e=0;e<timebox_long;e++){
                            var next_display=$('li').eq(c+1).find('.time-box').eq(e).css('display');
                            if(next_display=='block'){
                                next_num=next_num+1;
                            }
                        }
                        var name=$('li').eq(c).find('.name').text();
                        // console.log(name+'当前色块数量'+num);
                        //console.log(name+'下一个色块数量'+next_num);
                        if(next_num>num){
                            var new_obj=$('li').eq(c+1).clone(true);
                            //console.log(new_obj);
                            $('li').eq(c+1).empty();
                            $('li').eq(c+1).remove();
                            $('li').eq(0).after(new_obj);

                        }
                    }
                }

            }
            liorder();
            //除管理员外，按每一个的计划数量排序结束
            //设置姓名居中
            function namecenter() {
                var name_length=$('.name-text').length;
                for(var n=0;n<name_length;n++){
                    var name_text_height=$('.name-text').eq(n).height();
                    var name_height=$('.name-text').eq(n).parent('.name').height();
                    var name_top=(name_height-name_text_height)/2;
                    $('.name-text').eq(n).css({'top':name_top+'px'});
                }
            }
            namecenter();
            //设置姓名居中结束

            //日期按月份决定
            function monthdate() {
                var day_num=$('li').eq(0).find('.day').length;
                if(day_num==31){
                    $('.timetable').css({'width':'650px'});
                    $('.day-box').css({'width':'650px'});
                    $('.week-box').css({'width':'650px'});
                    $('.process-box').css({'width':'650px'});
                    $('.time-outbox').css({'width':'650px'});
                    $('.time-box').css({'width':'650px'});
                }else{
                    $('.timetable').css({'width':20*day_num+(day_num+1-1-1)+'px','border-right':'1px solid black','border-left':'1px solid black'});
                    $('.day-box').css({'width':20*day_num+(day_num+1-1-1)+'px'});
                    $('.week-box').css({'width':20*day_num+(day_num+1-1-1)+'px'});
                    $('.process-box').css({'width':20*day_num+(day_num+1-1)+'px'});
                    $('.time-outbox').css({'width':20*day_num+(day_num+1-1)+'px'});
                    $('.time-box').css({'width':20*day_num+(day_num+1-1-1)+'px'});
                    var line_left=$('.time-outbox').position().left-1;
                    //alert(line_left);
                    $('.line').css({'display':'block','left':line_left+'px'});
                }
            }
            monthdate();
            //日期按月份决定

            //日期悬浮效果
            function float() {
                $('li').each(function () {
                    var jqthis=$(this);
                    var jsthis=$(this)[0];
                    jsthis.c=jqthis.index();
                    var li_top=jqthis.offset().top;
                    var li_height=jqthis.height();
                    //console.log('li的高度'+li_height);
                    var li_bottom=li_top+li_height;
                    //console.log('li顶部'+li_top);
                    var timetable_top=jqthis.find('.timetable').offset().top;
                    // console.log('时间表'+timetable_top);
                    var timetable_left=jqthis.find('.timetable').offset().left;
                    // console.log('原来左侧'+timetable_left);
                    var td_height=jqthis.find('.td').height();
                    // console.log('td的高度'+td_height);
                    var window_height=$(window).height();
                    var timetable_width=jqthis.find('.timetable').width();
                    //console.log('时间表宽度'+timetable_width);
                    var process_width=jqthis.find('.process').width();
                    //console.log('外层宽度'+process_width);
                    var timetable_newleft=jqthis.find('.timetable').position().left;
                    //console.log('新左侧'+timetable_newleft)
                    function scrollmove(){
                        $(document).scrollLeft(0);
                        //console.log('浏览器可视区域高度'+window_height);
                        //console.log('li的高度'+li_height);
                        //console.log('第'+jsthis.c+'个');
                        var t=$(document).scrollTop();
                        /* if(jqthis.index()==jsthis.c){*/
                        if(t<=li_bottom && t>=li_top && window_height<li_height){
                            //console.log('滚动条高度'+t);
                            //console.log(1);
                            //console.log('现在左侧'+timetable_left);
                            var top=t-li_top-1;
                            var max_top=li_height-(8+37+8+1+60);
                            if(top>max_top){
                                top=max_top;
                            }
                            $('li').eq(jsthis.c).find('.timetable')
                                .css({'top':top+'px'});
                        }
                        if(t<timetable_top || t>li_bottom || window_height>li_height){
                            //console.log('滚动条高度'+t);
                            //console.log(2);
                            $('li').eq(jsthis.c).find('.timetable')
                                .css({'top':'0px'});
                            //console.log( $('li').eq(jsthis.c).find('.timetable').offset().left);
                        }
                        /*if(t<timetable_top){
                            console.log(3);
                            $('li').eq(jsthis.c).find('.timetable')
                                .css({'position':'relative',});
                            console.log( $('li').eq(jsthis.c).find('.timetable').offset().left);
                        }*/
                        /*else{
                            console.log(3);
                            $('li').eq(jsthis.c).find('.timetable')
                                .css({'position':'relative'});
                            console.log( $('li').eq(jsthis.c).find('.timetable').offset().left);
                        }*/
                    }
                    /* }*/
                    scrollmove();
                })
            }
            $(window).scroll(function () {
                float();
                loubtn();
            })
            //日期悬浮效果结束

            //设置色块的长度 位置
            var time_length=$('.time').length;
            var time=$('.time');
            for(var i=0;i<time_length;i++){
                var startdate=Number(time.eq(i).find('input[name=startdate]').val());
                var enddate=Number(time.eq(i).find('input[name=enddate]').val());
                var day=(enddate-startdate)+1;
                var time_width=20*day+(day-1);
                var time_left=20*(startdate-1)+(startdate-1);
                //var time_right=time_left+time_width;
                time.eq(i).css({'width':time_width+'px','left':time_left+'px'});

            }
            //设置色块的长度 位置结束

            //滑块右侧移入
            $('.time-right').mouseenter(function () {
                if($(this).parent('.time').hasClass('gray') || $(this).parent('.time').hasClass('green')){
                    $(this).css({'cursor':'not-allowed'});
            }else{
                    $(this).css({'cursor':'ew-resize'});
                }
            })
            //滑块右侧移入结束

            //滑块左侧移入
           $('.time-left').mouseenter(function () {
                if($(this).parent('.time').hasClass('gray') || $(this).parent('.time').hasClass('green')){
                    $(this).css({'cursor':'not-allowed'});
                }else{
                    $(this).css({'cursor':'ew-resize'});
                }
            })
            //滑块左侧移入结束

            //滑块移入
            $('.time').mouseenter(function () {
                if($(this).hasClass('gray') || $(this).hasClass('green')){
                    $(this).css({'cursor':'not-allowed'});
                }else{
                    $(this).css({'cursor':'move'});
                }
            })
            //滑块移入结束

            //滑块右侧拉短拉长
            $('.time-right').mousedown(function (ev) {
                if($(this).parent('.time').hasClass('gray') || $(this).parent('.time').hasClass('green') || $(this).siblings('.time-left').hasClass('left-width')){
                    return false;
                }else{
                    if($(this).parent('.time').hasClass('f') || $(this).hasClass('width')){
                        return false;
                    }
                    $(this).addClass('width');
                    m_left=ev.pageX;
                    old_width=$(this).parent('.time').width();
                    time_l=$(this).parent('.time').position().left;
                    //alert(time_left);
                    $(document).mousemove(function (ev) {
                        m_n_left=ev.pageX;
                        diff_left=m_n_left-m_left;
                        new_width=diff_left+old_width;
                        if(new_width<20){
                            new_width=20;
                        }
                        var max_long=$('.time-box').width();
                        max_width=max_long-time_l;
                        if(new_width>max_width){
                            new_width=max_width;
                        }
                        $('.width').parent('.time').css({'width':new_width+'px'});
                        $('.width').css({'right':'0px'});
                        $('.width').siblings('.time-left').css({'left':'0px'});
                    })
                }

            })
            $('.time-right').mouseup(function (ev) {
                ev.stopPropagation();
                $(document).off('mousemove');
                if($(this).parent('.time').hasClass('f') || $(this).siblings('.time-left').hasClass('left-width')){
                    return false;
                }
                if(p_width==old_width){
                    $('.width').removeClass('width');
                    return false;
                }else{
                    if(confirm('确定要改变时间吗')){
                        var p_width=$('.width').parent('.time').width();
                        //alert(p_width);
                        console.log('宽度'+p_width);
                        var day=parseInt((p_width+1)/20-1)+1;
                        //alert(day);
                        var startdate=Number($('.width').parent('.time').find('input[name=startdate]').val());
                        //alert(startdate);
                        var enddate=startdate+day-1;
                        if(enddate<startdate){
                            enddate=startdate
                        }
                        var max_enddate=$('li').eq(0).find('.day').length;
                        if(enddate>max_enddate){
                            enddate=max_enddate;
                        }
                        //alert(enddate);
                        console.log('结束时间'+enddate);
                        new_day=enddate-startdate+1;
                        var time_width=20*new_day+(new_day-1);
                        /* if(time_width<20){
                             time_width=20;
                         }*/
                        /*if(time_width>max_width){
                            time_width=max_width;
                        }*/
                        var id=Number($('.width').parent('.time').find('input[name=id]').val());
                        $('.width').parent('.time').find('input[name=enddate]').val(enddate);
                        $('.width').parent('.time').css({'width':time_width+'px'});
                        $('.width').css({'right':'0px'});
                        $('.width').siblings('.time-left').css({'left':'0px'});
                        $('.time-right').each(function () {
                            var jqthis = $(this);
                            var this_id = Number(jqthis.parent('.time').find('input[name=id]').val());
                            if (this_id == id) {
                                jqthis.addClass('width');
                                jqthis.parent('.time').find('input[name=enddate]').val(enddate);
                                jqthis.parent('.time').css({'width': time_width + 'px'});
                                jqthis.css({'right': '0px'});
                                jqthis.siblings('.time-left').css({'left': '0px'});
                            }
                        })
                        //alert(time_width);
                        $.ajax({
                            url:"http://work.linran136.com/index/index/dutywidth",
                            data:{id:id,enddate:enddate},
                            type:'post',
                            success:function (reg) {
                                console.log(reg);
                                if(reg){
                                    $('.width').removeClass('width');
                                }
                            }
                        })
                    }else{
                        $('.width').parent('.time').css({'width':old_width+'px'});
                        $('.width').css({'right':'0px'});
                        $('.width').siblings('.time-left').css({'left':'0px'});
                        $('.width').removeClass('width');
                    }
                }

            })
            //滑块右侧拉短拉长结束

            //滑块左侧拉短拉长
            $('.time-left').mousedown(function (ev) {
                if($(this).parent('.time').hasClass('gray') || $(this).parent('.time').hasClass('green')){
                    return false;
                }else{
                    if($(this).parent('.time').hasClass('f') || $(this).siblings('.time-right').hasClass('width') || $(this).hasClass('left-width')){
                       // alert(1);
                        return false;
                    }
                    $(this).addClass('left-width');
                    m_left=ev.pageX;
                    old_width=$(this).parent('.time').width();
                    time_l=$(this).parent('.time').position().left;
                    console.log('旧左侧'+time_l);
                    time_r=time_l+old_width;
                    //alert(time_r);
                    console.log('右侧'+time_r);
                    console.log('旧宽度'+old_width);
                    //alert(time_left);
                    $(document).mousemove(function (ev) {
                        m_n_left=ev.pageX;
                        diff_left=m_n_left-m_left;
                       // new_width=diff_left+old_width;
                        new_left=diff_left+time_l;
                        console.log('新左侧'+new_left);
                      /*  if(new_width<20){
                            new_width=20;
                        }
                        max_width=650-time_r;
                        if(new_width>max_width){
                            new_width=max_width;
                        }*/
                        if(new_left<0){
                            new_left=0
                        }
                        var max_l=time_r-20;
                        if(new_left>max_l){
                            new_left=max_l;
                        }
                        new_width=time_r-new_left;
                        console.log('新宽度'+new_width);
                        $('.left-width').parent('.time').css({'left':new_left+'px'});
                        $('.left-width').parent('.time').css({'width':new_width+'px'});
                        $('.left-width').css({'left':'0px'});
                        $('.left-width').siblings('.time-right').css({'right':'0px'});
                        //$('.width').parent('.time').css({'right':time_r+'px'});
                    })
                }

            })
            $('.time-left').mouseup(function (ev) {
                ev.stopPropagation();
                $(document).off('mousemove');
                    var end_left=$(this).parent('.time').position().left;
                    if(end_left==time_l){
                       $('.left-width').removeClass('left-width');
                       return false;
                    }else{
                        if(confirm('确定要改变时间吗？')){
                            //alert(p_width);
                            var  startdate=parseInt(end_left/21)+1;
                            //alert(day);
                            var enddate=Number($('.left-width').parent('.time').find('input[name=enddate]').val());
                            //alert(startdate);
                            console.log('左侧拉动时鼠标按下时的结束时间'+enddate);
                            if(startdate<1){
                                startdate=1;
                            }
                            if(startdate>enddate){
                                startdate=enddate;
                            }
                            console.log('左侧拉动时新的开始时间'+startdate);
                            time_end_left=20*(startdate-1)+(startdate-1);
                            console.log('左侧拉动抬起新左侧'+time_end_left);
                            time_end_width=time_r-time_end_left ;
                            console.log('左侧拉动抬起新宽度'+time_end_width);
                            $('.left-width').parent('.time').find('input[name=startdate]').val(startdate);
                            $('.left-width').parent('.time').css({'width':time_end_width+'px'});
                            $('.left-width').parent('.time').css({'left':time_end_left+'px'});
                            $('.left-width').css({'left':'0px'});
                            $('.left-width').siblings('.time-right').css({'right':'0px'});
                            var id=Number($('.left-width').parent('.time').find('input[name=id]').val());
                            //alert(time_width);
                            $('.time-left').each(function () {
                                var jqthis = $(this);
                                var this_id = Number(jqthis.parent('.time').find('input[name=id]').val());
                                if (this_id == id) {
                                    jqthis.addClass('left-width');
                                    jqthis.parent('.time').find('input[name=startdate]').val(startdate);
                                    jqthis.parent('.time').css({'width':time_end_width+'px'});
                                    jqthis.parent('.time').css({'left':time_end_left+'px'});
                                    jqthis.css({'left':'0px'});
                                    jqthis.siblings('.time-right').css({'right':'0px'});
                                }
                            })
                            $.ajax({
                                url:"http://work.linran136.com/index/index/dutyleftwidth",
                                data:{id:id,startdate:startdate},
                                type:'post',
                                success:function (reg) {
                                    console.log(reg);
                                    if(reg){
                                        $('.left-width').removeClass('left-width');
                                    }
                                }
                            })
                        }else{
                            $('.left-width').parent('.time').css({'width':old_width+'px'});
                            $('.left-width').parent('.time').css({'left':time_l+'px'});
                            $('.left-width').css({'left':'0px'});
                            $('.left-width').siblings('.time-right').css({'right':'0px'});
                            $('.left-width').removeClass('left-width');
                        }
                    }

            })
            //滑块左侧拉短拉长结束

            //左右移动
            $('.time').mousedown(function (ev) {
                if($(this).hasClass('gray') || $(this).hasClass('green')){
                    return false;
                }else {
                    if($(this).find('.time-right').hasClass('width') || $(this).find('.time-left').hasClass('left-width') || $(this).hasClass('f')){
                        return false;
                    }
                   $(this).addClass('f');
                   mouse_left=ev.pageX;
                   o_left=$(this).position().left;
                   //alert(mouse_left)
                    console.log('移动鼠标按下时的左侧'+o_left);
                   t_width=$(this).width();
                    console.log('移动鼠标按下时的宽度'+t_width);
                   //获得每一个li在浏览器的位置
                    /* li_top=$('.li').eq(0).offset().top;
                  // alert(li_top);
                    li_bottom=li_top+431;
                    a=$(this).parents('.li').index();
                    //alert(a);
                    //alert($('.li').eq(a).offset().top);
                    this_li_top=li_top+a*431
                    this_li_bottom=li_top+a*431+431;*/
                   $(document).mousemove(function (ev) {
                      // console.log(ev.target);
                     var mouse_new_left=ev.pageX;
                     var mouse_new_top=ev.pageY;
                     var differ_left=mouse_new_left-mouse_left;
                     var time_new_left=o_left+differ_left;
                     if(time_new_left<0){
                         time_new_left=0;
                     }
                     var max_long=$('.time-box').width();
                     max_left=max_long-t_width;
                     if(time_new_left>max_left){
                         time_new_left=max_left;
                     }
                       //console.log('移动时鼠标移动时的左侧'+time_new_left);
                       $('.f').css({'left':time_new_left+'px'});
                       $('.f').find('.time-right').css({'right':'0px'});
                       $('.f').find('.time-left').css({'left':'0px'});

                      /* if(mouse_new_top>=this_li_top && mouse_new_top<=this_li_bottom){
                           $('.f').find('.time-right').css({'right':'0px'});
                           $('.f').css({'left':time_new_left+'px'});
                       }else{
                           var obj=$('.f').clone(true);
                           console.log(obj);
                           $('.f').append(obj);
                           obj.find('.time-right').css({'right':'0px'});
                           obj.css({'left':time_new_left+'px'});
                       }*/

                   })
                }
            })
            $('.time').mouseup(function (ev) {
                //var m_last_top=ev.pageY;
                $(document).off('mousemove');
                if($(this).find('.time-right').hasClass('width') || $(this).find('.time-left').hasClass('left-width')){
                    return false;
                }
                var time_left=$(this).position().left;
                if(time_left==o_left){
                    $('.f').removeClass('f');
                    return false;
                }
                if(confirm('确定要改变时间吗？')){
                    console.log('移动时鼠标抬起时的左侧'+time_left);
                    //alert(time_left);
                    var old_startdate=Number($('.f').find('input[name=startdate]').val());
                    console.log('移动时鼠标抬起旧的开始时间'+old_startdate);
                    startdate=parseInt(time_left/21)+1;
                    console.log('移动时鼠标抬起新的开始时间'+startdate);
                    if(startdate<1){
                        startdate=1;
                    }

                    var ahead=0;
                    if(startdate<old_startdate){
                        ahead=1;
                    }else {
                        ahead=0;
                    }
                    var old_enddate=Number($('.f').find('input[name=enddate]').val());
                    var old_day=old_enddate-old_startdate+1;
                    console.log('移动时的天数'+old_day);
                    var max_enddate=$('li').eq(0).find('.day').length;
                    var max_startdate=max_enddate-old_day+1;
                    if(startdate>max_startdate){
                        startdate=max_startdate;
                    }
                    var enddate=startdate+old_day-1;
                    //alert(startdate);
                    //alert(enddate);
                    console.log('移动时鼠标抬起新的结束时间'+enddate);
                    var time_n_left=20*(startdate-1)+(startdate-1);
                    $('.f').find('input[name=startdate]').val(startdate);
                    $('.f').find('input[name=enddate]').val(enddate);
                    $('.f').css({'left':time_n_left+'px'});
                    $('.f').find('.time_right').css({'right':'0px'});
                    $('.f').find('.time-left').css({'left':'0px'});
                    if(ahead==1){
                        $('.f').css({'background':'blue'});
                    }
                    var id=Number($(this).find('input[name=id]').val());
                    $('.time').each(function () {
                        var jqthis = $(this);
                        var this_id = Number(jqthis.find('input[name=id]').val());
                        if (this_id == id) {
                            jqthis.addClass('f');
                            jqthis.find('input[name=startdate]').val(startdate);
                            jqthis.find('input[name=enddate]').val(enddate);
                            jqthis.css({'left':time_n_left+'px'});
                            jqthis.find('.time_right').css({'right':'0px'});
                            jqthis.find('.time-left').css({'left':'0px'});
                            if(ahead==1){
                                jqthis.css({'background':'blue'});
                            }
                        }
                    })
                    //console.log(ahead);
                    $.ajax({
                        url:'http://work.linran136.com/index/index/dutyleft',
                        data:{id:id,startdate:startdate,enddate:enddate,ahead:ahead},
                        type:'post',
                        success:function (reg) {
                            console.log(reg);
                            if(reg){
                                $('.f').removeClass('f');
                            }
                        }
                    })
                }else{
                    $('.f').css({'left':o_left+'px'});
                    $('.f').find('.time_right').css({'right':'0px'});
                    $('.f').find('.time-left').css({'left':'0px'});
                    $('.f').removeClass('f');
                }
            })
            //左右移动结束

            //处理完成
            $('.btn').click(function () {
                if(confirm('确定任务已完成了吗？')){
                    var c=$(this).parent('.status-every').index();
                    // alert(c);
                    $(this).parent('.status-every').addClass('handle');
                    var t=$(this).parents('.status').siblings('.process').find('.time-box')
                        .eq(c).find('.time');
                    t.addClass('green');
                    t.css({'background':'green'});
                    $('.handle').text('已完成');
                    var id=Number(t.find('input[name=id]').val());
                    $.ajax({
                        url:'http://work.linran136.com/index/index/dutyrwjd',
                        data:{id:id},
                        type:'post',
                        success:function (reg) {
                            console.log(reg);
                            if(reg){
                                $('.handle').removeClass('handle');
                            }
                        }
                    })
                }

            })
            //处理完成结束

            //双击进入任务编辑页
//            $('.time').dblclick(function () {
//                var id=Number($(this).find('input[name=id]').val());
//                window.open('http://work.linran136.com/admin/plan/edit.html?id='+id);
//            })
            //双击进入任务编辑页结束

            //默认当前年
            var now_year=(new Date()).getFullYear();
            //alert(now_year);
            var new_year=Number($('input[name=nian]').val());
            // alert(new_month);
            if(new_year){
                $('select[name=year]').val(new_year);
                $('.year-text').text(new_year)
            }else{
                $('select[name=year]').val(now_year);
                $('.year-text').text(now_year)
            }
            //默认当前年结束

            //默认当前月
            var now_month=new Date().getMonth()+1;
            // alert(new_month);
            var new_month=Number($('input[name=yue]').val());
            // alert(new_month);
            if(new_month){
                $('select[name=month]').val(new_month);
                $('.month-text').text(new_month);
            }else{
                $('select[name=month]').val(now_month);
                $('.month-text').text(now_month);
            }
            //默认当前月结束

            //星期按月份的日期确定
            function weekdaytext() {
                //alert(new Date());
                var li_length=$('li').length;
                for(var j=0;j<li_length;j++){
                    //console.log('j='+j);
                    var day_length=$('li').eq(j).find('.day').length;
                    //console.log('天数'+day_length);
                    for(var i=0;i<day_length;i++){
                        //console.log('i='+i);
                        var day=Number($('li').eq(j).find('.day').eq(i).text());
                        var index=$('li').eq(j).find('.day').eq(i).index();
                        console.log('第几'+index);
                        var year=Number($('select[name=year]').val());
                        var month=Number($('select[name=month]').val());
                        var present_time=new Date();
                        var present_year=present_time.getFullYear();
                        var present_month=present_time.getMonth()+1;
                        var present_day=present_time.getDate();
                        //console.log('今年'+present_year);
                        //console.log('本月'+present_month);
                        //console.log('本天'+present_day);
                        //console.log('当天日期'+present_year+'-'+present_month+'-'+present_day);
                        //console.log('日期'+year+'-'+month+'-'+day);
                        if(present_year==year && present_month==month && present_day==day){
                            //console.log('当天');
                            $('li').eq(j).find('.day').eq(i).css({'background':'blue'})
                                .parent('.day-box').siblings('.week-box').find('.week').eq(i)
                                .css({'background':'blue'});
                        }
                        var time=new Date(year,month-1,day-1,34,33,33);
                        console.log('日期'+time);
                        var weekday=time.getDay();
                        //console.log('周几'+weekday);
                        if(weekday==0){
                            var weektime='日'
                        }else if(weekday==1){
                            var weektime='一';
                        }else if(weekday==2){
                            var weektime='二';
                        }else if(weekday==3){
                            var weektime='三';
                        }else if(weekday==4){
                            var weektime='四';
                        }else if(weekday==5){
                            var weektime='五';
                        }else if(weekday==6){
                            var weektime='六';
                        }
                        //console.log('星期'+weektime);
                        var father=$('li').eq(j).find('.day').eq(i).parent('.day-box');
                        father.siblings('.week-box').find('.week').eq(index).text(weektime);
                    }
                }
            }
            weekdaytext();
            //星期按月份日期确定结束

            //确定年月
            $('.confirm').click(function () {
                var year=Number($('select[name=year]').val());
                var month=Number($('select[name=month]').val());
                location.href='http://work.linran136.com/index/index/duty.html?year='+year+'&month='+month;
            })
            //确定年月结束

            //计划任务导航图切换
            $('.nav-btn').click(function () {
                //alert(1);
               /* if($(this).text()=='任务横道图') {
                    var text = '计划横道图';
                    $('.nav-btn').html(text);
                    $('input[name=nav]').val('计划');
                }else if($(this).text()=='计划横道图'){
                    var text = '任务横道图';
                    $('.nav-btn').text(text);
                    $('input[name=nav]').val('任务');
                }*/
                var year=Number($('select[name=year]').val());
                var month=Number($('select[name=month]').val());
                location.href='http://work.linran136.com/index/index/index.html?year='+year+'&month='+month;
            })
            //计划任务导航图切换结束

            //所有任务重要程度选择
            $('.duty-header-text').click(function () {
                $(this).hide();
                $('.duty-header-select').show();
            })
            $('.duty-header-select').change(function () {
                var value=$(this).val();
                var status_header_select=$('.status-header-select');
                var status_header_val=status_header_select.val();
                if($(this).val()==1){
                    if(status_header_val==0){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').show();
                        $('.important-finish').hide();
                        $('.usual-finish').hide();
                    }else if(status_header_val==1){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').hide();
                        $('.important-finish').show();
                        $('.usual-finish').hide();
                    }else if(status_header_val==2){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').show();
                        $('.important-finish').show();
                        $('.usual-finish').hide();
                    }
                    $(this).siblings('.duty-header-text').show().text('重要任务');
                }else if($(this).val()==0){
                    if(status_header_val==0){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').hide();
                        $('.important-finish').hide();
                        $('.usual-finish').hide();
                    }else if(status_header_val==1){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').hide();
                        $('.important-finish').hide();
                        $('.usual-finish').show();
                    }else if(status_header_val==2){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').hide();
                        $('.important-finish').hide();
                        $('.usual-finish').show();
                    }
                    $(this).siblings('.duty-header-text').show().text('一般任务');
                }else if($(this).val()==3){
                    if(status_header_val==0){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').show();
                        $('.important-finish').hide();
                        $('.usual-finish').hide();
                    }else if(status_header_val==1){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').hide();
                        $('.important-finish').show();
                        $('.usual-finish').show();
                    }else if(status_header_val==2){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').show();
                        $('.important-finish').show();
                        $('.usual-finish').show();
                    }
                    $(this).siblings('.duty-header-text').show().text('全部任务');
                }
                dutycenter();
                liheight();
                liorder();
                namecenter();
                weekdaytext();
                var select_length=$('.duty-every-header-select').length;
                //alert(select_length);
                var totalexp=new Date();
                totalexp.setTime(totalexp.getTime()+60*1000*60*24*7);
                document.cookie='dutytotalimportance='+value+';expires='+totalexp.toGMTString();
                for(var s=0;s<select_length;s++){
                    var duty_text=$('.duty-header-text').text();
                    $('.duty-every-header-text').text(duty_text);
                    $('.duty-every-header-select').eq(s).val(value);
                    var exp=new Date();
                    exp.setTime(exp.getTime()+60*1000*60*24*7);
                    var vid=Number($('li').eq(s).find('input[name=vid]').val());
                    document.cookie='dutyimportance'+vid+'='+value+';expires='+exp.toGMTString();
                }
                $(this).hide();
            })
            //所有任务重要程度选择结束

            //每个人的任务重要程度选择
            $('.duty-every-header-text').click(function () {
                $(this).hide();
                $(this).siblings('.duty-every-header-select').show();
            })
            $('.duty-every-header-select').change(function () {
                var h=$(this).parents('li').index();
                var this_status_val=$('li').eq(h).find('.status-every-header-select').val();
                //alert(h);
                if($(this).val()==1){
                    if(this_status_val==0){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_status_val==1){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_status_val==2){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').hide();
                    }
                    $(this).siblings('.duty-every-header-text').show().text('重要任务');
                }else if($(this).val()==0){
                    if(this_status_val==0){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_status_val==1){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').show();
                    }else if(this_status_val==2){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').show();
                    }
                    $(this).siblings('.duty-every-header-text').show().text('一般任务');
                }else if($(this).val()==3){
                    if(this_status_val==0){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_status_val==1){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').show();
                    }else if(this_status_val==2){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').show();
                    }
                    $(this).siblings('.duty-every-header-text').show().text('全部任务');
                }
                var value=$(this).val();
                var exp=new Date();
                exp.setTime(exp.getTime()+60*1000*60*24*7);
                var vid=Number($('li').eq(h).find('input[name=vid]').val());
                document.cookie='dutyimportance'+vid+'='+value+';expires='+exp.toGMTString();
                $(this).hide();
                dutycenter();
                liheight();
                namecenter();
                weekdaytext();
            })
            //每个人的任务重要程度选择结束

            //所有任务完成状态选择
            $('.status-header-text').click(function () {
                $(this).hide();
                $('.status-header-select').show();
            })
            $('.status-header-select').change(function () {
                var value=$(this).val();
                var duty_header_select=$('.duty-header-select');
                var duty_header_val=duty_header_select.val();
                if($(this).val()==0){
                    if(duty_header_val==1){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').show();
                        $('.important-finish').hide();
                        $('.usual-finish').hide();
                    }else if(duty_header_val==0){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').hide();
                        $('.important-finish').hide();
                        $('.usual-finish').hide();
                    }else if(duty_header_val==3){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').show();
                        $('.important-finish').hide();
                        $('.usual-finish').hide();
                    }
                    $(this).siblings('.status-header-text').show().text('未完成任务');
                }else if($(this).val()==1){
                    if(duty_header_val==1){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').hide();
                        $('.important-finish').show();
                        $('.usual-finish').hide();
                    }else if(duty_header_val==0){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').hide();
                        $('.important-finish').hide();
                        $('.usual-finish').show();
                    }else if(duty_header_val==3){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').hide();
                        $('.important-finish').show();
                        $('.usual-finish').show();
                    }
                    $(this).siblings('.status-header-text').show().text('已完成任务');
                }else if($(this).val()==2){
                    if(duty_header_val==1){
                        $('.usual-unfinish').hide();
                        $('.important-unfinish').show();
                        $('.important-finish').show();
                        $('.usual-finish').hide();
                    }else if(duty_header_val==0){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').hide();
                        $('.important-finish').hide();
                        $('.usual-finish').show();
                    }else if(duty_header_val==3){
                        $('.usual-unfinish').show();
                        $('.important-unfinish').show();
                        $('.important-finish').show();
                        $('.usual-finish').show();
                    }
                    $(this).siblings('.status-header-text').show().text('全部任务');
                }
                dutycenter();
                liheight();
                liorder();
                namecenter();
                weekdaytext();
                var select_length=$('.status-every-header-select').length;
                //alert(select_length);
                var totalexp=new Date();
                totalexp.setTime(totalexp.getTime()+60*1000*60*24*7);
                document.cookie='dutytotalstatus='+value+';expires='+totalexp.toGMTString();
                for(var s=0;s<select_length;s++){
                    var status_text=$('.status-header-text').text();
                    $('.status-every-header-text').text(status_text);
                    $('.status-every-header-select').eq(s).val(value);
                    var exp=new Date();
                    exp.setTime(exp.getTime()+60*1000*60*24*7);
                    var vid=Number($('li').eq(s).find('input[name=vid]').val());
                    document.cookie='dutyfinish'+vid+'='+value+';expires='+exp.toGMTString();
                }
                $(this).hide();
            })
            //所有任务完成状态选择结束

            //每个人的任务完成状态选择
            $('.status-every-header-text').click(function () {
                $(this).hide();
                $(this).siblings('.status-every-header-select').show();
            })
            $('.status-every-header-select').change(function () {
                var h=$(this).parents('li').index();
                var this_duty_val=$('li').eq(h).find('.duty-every-header-select').val();
                //alert(h);
                if($(this).val()==0){
                    if(this_duty_val==1){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_duty_val==0){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_duty_val==3){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').hide();
                    }
                    $(this).siblings('.status-every-header-text').show().text('未完成任务');
                }else if($(this).val()==1){
                    if(this_duty_val==1){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_duty_val==0){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').show();
                    }else if(this_duty_val==3){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').show();
                    }
                    $(this).siblings('.status-every-header-text').show().text('已完成任务');
                }else if($(this).val()==2){
                    if(this_duty_val==1){
                        $('li').eq(h).find('.usual-unfinish').hide();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').hide();
                    }else if(this_duty_val==0){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').hide();
                        $('li').eq(h).find('.important-finish').hide();
                        $('li').eq(h).find('.usual-finish').show();
                    }else if(this_duty_val==3){
                        $('li').eq(h).find('.usual-unfinish').show();
                        $('li').eq(h).find('.important-unfinish').show();
                        $('li').eq(h).find('.important-finish').show();
                        $('li').eq(h).find('.usual-finish').show();
                    }
                    $(this).siblings('.status-every-header-text').show().text('全部任务');
                }
                var value=$(this).val();
                var exp=new Date();
                exp.setTime(exp.getTime()+60*1000*60*24*7);
                var vid=Number($('li').eq(h).find('input[name=vid]').val());
                document.cookie='dutyfinish'+vid+'='+value+';expires='+exp.toGMTString();
                $(this).hide();
                dutycenter();
                liheight();
                namecenter();
                weekdaytext();
            })
            //每个人的任务完成状态选择结束
            //任务详情底部超出浏览器可视区域解决办法
            function morebottom() {
                var jqthis=$('.enter');
                var p_length=jqthis.find('.content').length;
                var content_height=0;
                for(var p=0;p<p_length;p++){
                    var p_height=jqthis.find('.content').eq(p).height()+10;
                    content_height=content_height+p_height;
                }
                jqthis.css({'height':content_height+'px'});
                var content_top=jqthis.offset().top;
                //console.log('内容头部'+content_top);
                var content_bottom=content_height+content_top;
                //console.log('内容底部'+content_bottom);
                var ul_height=$('ul').height();
                var ul_top=$('ul').offset().top;
                var ul_bottom=ul_height+ul_top;
                $('body').css({'height':ul_bottom+10+'px'});
                //console.log('内容高度'+content_height);
                if(content_bottom>ul_bottom){
                    var diff_top=content_bottom-ul_bottom;
                    //console.log('超过');
                    jqthis.css({'top':-diff_top+'px'});
                }else{
                    jqthis.css({'top':'0px'});
                }
            }
            //任务详情底部超出浏览器可视区域解决办法

            //任务详情显示
            $('.duty-text').mouseenter(function () {
                //alert(1);
                if($('.enter').length>0){
                    return false;
                }else{
                    $(this).find('.duty-content').addClass('enter');
                    morebottom();
                    $('.enter').mouseenter(function () {
                        //alert(1);
                        $(this).addClass('enter');
                        morebottom();
                    })
                    $('.enter').mouseleave(function () {
                        //alert(1);
                        $(this).removeClass('enter');
                    })
                }
            })

            $('.duty-text').mouseleave(function () {
                $(this).find('.duty-content').removeClass('enter');
            })
            //任务详情显示结束

            //选择员工按钮在浏览器高度居中
            function loubtn() {
                var li_top=$('li').eq(0).offset().top;
                var stop=$(document).scrollTop();
                if(stop>li_top){
                    $('.lou-btn').css({'display':'block'});
                    var loubtn_height=$('.lou-btn').height()+10;
                    var window_height=$(window).height();
                    $('.lou-btn').css({'top':(window_height-loubtn_height)/2+'px'});
                }else{
                    $('.lou-btn').css({'display':'none'});
                }
            }
            //选择员工按钮在浏览器高度居中结束

            //楼层在浏览器高度居中
            function loubox() {
                var lou_length=$('.lou').length;
                for(var x=0;x<lou_length;x++){
                    var name=$('li').eq(x).find('.name-text').find('.person-name').text();
                    $('.lou').eq(x).text(name);
                }
                var loubox_height=35*lou_length+2*(lou_length-1);
                var window_height=$(window).height();
                $('.lou-box').css({'top':(window_height-loubox_height)/2+'px'});
            }
            loubox();
            //楼层在浏览器高度居中结束

            //鼠标移入选择员工按钮，楼层出来
            $('.lou-btn').mouseenter(function () {
                $('.lou-box').show();
                loubox();
                $(this).hide();
            })
            $('.lou-box').mouseleave(function () {
                loubtn();
                $(this).hide();
            })
            //鼠标移入选择员工按钮，楼层出来结束

            //点击楼层的每一个员工姓名，滚动条滑动哪个员工的那一栏
            $('.lou').click(function () {
                var index=$(this).index();
                var litop=$('li').eq(index).offset().top;
                $('body').animate({'scrollTop':litop+'px'},200);
                $('.lou-box').hide();
                loubtn();
            })
            //点击楼层的每一个员工姓名，滚动条滑动哪个员工的那一栏结束
               })
    </script>
</head>
<body>
<!--头部区域-->
<div class="header">
    <a href="{:url('admin/entry/index')}">去后台</a>
</div>
<!--头部区域结束-->
<div class="box">
    <!--标题区域-->
    <h1><span class="year-text">2018</span>年度<span class="month-text">1</span>月任务安排</h1>
    <!--标题区域结束-->
    <!--色块提示区域-->
    <div class="notice">
        <div class="nav-box">
            <a class="nav-btn" href="javascript:;">计划横道图</a>
            <input type="hidden" name="nav" value="{:input('param.nav')}">
        </div>
        <div class="date-box">
            <select name="year">
                <option value="2016">2016年</option>
                <option value="2017">2017年</option>
                <option value="2018">2018年</option>
                <option value="2019">2019年</option>
                <option value="2020">2020年</option>
                <option value="2021">2021年</option>
                <option value="2022">2022年</option>
                <option value="2023">2023年</option>
                <option value="2024">2024年</option>
                <option value="2025">2025年</option>
                <option value="2026">2026年</option>
            </select>
            <select name="month">
                <option value="1">1月</option>
                <option value="2">2月</option>
                <option value="3">3月</option>
                <option value="4">4月</option>
                <option value="5">5月</option>
                <option value="6">6月</option>
                <option value="7">7月</option>
                <option value="8">8月</option>
                <option value="9">9月</option>
                <option value="10">10月</option>
                <option value="11">11月</option>
                <option value="12">12月</option>
            </select>
            <a class="confirm" href="javascript:;">确定</a>
            <input type="hidden" name="nian" value="{:input('param.year')}">
            <input type="hidden" name="yue" value="{:input('param.month')}">
        </div>
        <div class="notice-box">
        <p>
            <span class="explain">一般：</span>
            <span class="color pink"></span>
        </p>
        <p>
            <span class="explain">重要：</span>
            <span class="color orange"></span>
        </p>
            <p>
                <span class="explain">提前：</span>
                <span class="color blue"></span>
            </p>
        <p>
            <span class="explain">已完成：</span>
            <span class="color green"></span>
        </p>
        </div>
    </div>
    <!--色块提示区域-->
    <!--表格头部区域-->
    <div class="header">
        <div class="name">员工姓名</div>
        <div class="duty">
            <div class="duty-header-text">
                {if condition="$dutytotalimportance==1"}重要任务{/if}
                {if condition="$dutytotalimportance==0"}一般任务{/if}
                {if condition="$dutytotalimportance==3"}全部任务{/if}
            </div>
            <select class="duty-header-select">
                <option value="1" {if condition="$dutytotalimportance==1"} selected {/if}>重要任务</option>
                <option value="0" {if condition="$dutytotalimportance==0"} selected {/if}>一般任务</option>
                <option value="3" {if condition="$dutytotalimportance==3"} selected {/if}>全部任务</option>
            </select>
        </div>
       <!-- <div class="title">计划名称</div>-->
        <div class="num">数量</div>
        <div class="process">任务进程</div>
        <div class="status">
            <div class="status-header-text">
                {if condition="$dutytotalstatus==0"}未完成任务{/if}
                {if condition="$dutytotalstatus==1"}已完成任务{/if}
                {if condition="$dutytotalstatus==2"}全部任务{/if}
            </div>
            <select class="status-header-select">
                <option value="0" {if condition="$dutytotalstatus==0"} selected {/if}>未完成任务</option>
                <option value="1" {if condition="$dutytotalstatus==1"} selected {/if}>已完成任务</option>
                <option value="2" {if condition="$dutytotalstatus==2"} selected {/if}>全部任务</option>
            </select>
        </div>
</div>
    <!--表格头部区域结束-->
    <!--表格主体区域-->
    <ul class="ul">
        {foreach name='data' item='v'}
        <li class="li">
            <div class="name">
                <input type="hidden" name="vid" value="{$v['vid']}">
                <div class="name-text">
                    <span class="person-name">{$v['name']}</span>
                </div>
            </div>
            <div class="duty">
                <div class="duty-header">
                    <div class="duty-every-header-text">重要任务</div>
                    <select class="duty-every-header-select">
                        <option value="1" {if condition="$v['dutyimportance']==1"} selected {/if}>重要任务</option>
                        <option value="0" {if condition="$v['dutyimportance']==0"} selected {/if}>一般任务</option>
                        <option value="3" {if condition="$v['dutyimportance']==3"} selected {/if}>全部任务</option>
                    </select>
                </div>
                <div class="duty-box">
                    {foreach name="v['duty']" item='vo'}
                    {if condition="$vo['zycd']==1"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="duty-every important-unfinish">
                        <div class="duty-text">
                            {if condition="$vo['url']"}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：$vo['plan']
                                </p>
                            </div>
                            {else /}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：{$vo['plan']}</p>
                            </div>
                            {/if}
                        </div>
                    </div>
                    {else /}
                    <div class="duty-every important-finish">
                        <div class="duty-text">
                            {if condition="$vo['url']"}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：$vo['plan']
                                </p>
                            </div>
                            {else /}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：{$vo['plan']}</p>
                            </div>
                            {/if}
                        </div>
                    </div>
                    {/if}
                    {/if}
                    {if condition="$vo['zycd']==0"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="duty-every usual-unfinish">
                        <div class="duty-text">
                            {if condition="$vo['url']"}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：{$vo['plan']}</p>
                            </div>
                            {else /}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：{$vo['plan']}</p>
                            </div>
                            {/if}
                        </div>
                    </div>
                    {else /}
                    <div class="duty-every usual-finish">
                        <div class="duty-text">
                            {if condition="$vo['url']"}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：{$vo['plan']}</p>
                            </div>
                            {else /}
                            <a class="url" target="_blank" href="http://oa.jiaat.com/mobile/rwgl/view.php?id={$vo['id']}">{$vo['title']}</a>
                            <div class="duty-content">
                                <p class="content">任务名称：{$vo['title']}</p>
                                <p class="content">任务类型：{$vo['rwlb']}</p>
                                <p class="content">
                                    任务进度：{if condition="$vo['rwjd']"}
                                    已完成
                                    {else /}
                                    进行中
                                    {/if}
                                </p>
                                <p class="content">重要程度：
                                    {if condition="$vo['zycd']"}
                                    重要
                                    {else /}
                                    一般
                                    {/if}
                                </p>
                                <p class="content">负责人：{$vo['zrr']}</p>
                                <p class="content">执行人：{$vo['user']}</p>
                                <p class="content">开始日期：{$vo['startdate']}</p>
                                <p class="content">结束日期：{$vo['enddate']}</p>
                                <p class="content">备注：{$vo['note']}</p>
                                <p class="content">相关计划：{$vo['plan']}</p>
                            </div>
                            {/if}
                        </div>
                    </div>
                    {/if}
                    {/if}
                    {/foreach}
                </div>
            </div>
            <!--<div class="title">
                <div class="title-header">
                    计划名称
                </div>
                <div class="title-box">
                    {foreach name="v['duty']" item='vo'}
                    <div class="title-every">
                        {if condition="$vo['url']"}
                        <div class="titie_text">
                            <a class="url" target="_blank" href="{$vo['url']}">{$vo['title']}</a>
                        </div>
                        {else /}
                        <div class="title-text">
                            {$vo['title']}
                        </div>
                        {/if}
                    </div>
                    {/foreach}
                </div>
            </div>-->
            <div class="num">
                <div class="num-header">
                    数量
                </div>
                <div class="num-box">
                    {foreach name="v['duty']" item='vo'}
                    {if condition="$vo['zycd']==1"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="num-every important-unfinish">
                    </div>
                    {else /}
                    <div class="num-every important-finish">
                    </div>
                    {/if}
                    {/if}
                    {if condition="$vo['zycd']==0"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="num-every usual-unfinish">
                    </div>
                    {else /}
                    <div class="num-every usual-finish">
                    </div>
                    {/if}
                    {/if}
                    {/foreach}
                </div>
            </div>
            <div class="process">
                <div class="timetable">
                    <div class="day-box">
                        {if condition="in_array($presentMonth,[1,3,5,7,8,10,12])"}
                        <p class="day">01</p>
                        <p class="day">02</p>
                        <p class="day">03</p>
                        <p class="day">04</p>
                        <p class="day">05</p>
                        <p class="day">06</p>
                        <p class="day">07</p>
                        <p class="day">08</p>
                        <p class="day">09</p>
                        <p class="day">10</p>
                        <p class="day">11</p>
                        <p class="day">12</p>
                        <p class="day">13</p>
                        <p class="day">14</p>
                        <p class="day">15</p>
                        <p class="day">16</p>
                        <p class="day">17</p>
                        <p class="day">18</p>
                        <p class="day">19</p>
                        <p class="day">20</p>
                        <p class="day">21</p>
                        <p class="day">22</p>
                        <p class="day">23</p>
                        <p class="day">24</p>
                        <p class="day">25</p>
                        <p class="day">26</p>
                        <p class="day">27</p>
                        <p class="day">28</p>
                        <p class="day">29</p>
                        <p class="day">30</p>
                        <p style="border-right: none" class="day">31</p>
                        {/if}
                        {if condition="in_array($presentMonth,[4,6,9,11])"}
                        <p class="day">01</p>
                        <p class="day">02</p>
                        <p class="day">03</p>
                        <p class="day">04</p>
                        <p class="day">05</p>
                        <p class="day">06</p>
                        <p class="day">07</p>
                        <p class="day">08</p>
                        <p class="day">09</p>
                        <p class="day">10</p>
                        <p class="day">11</p>
                        <p class="day">12</p>
                        <p class="day">13</p>
                        <p class="day">14</p>
                        <p class="day">15</p>
                        <p class="day">16</p>
                        <p class="day">17</p>
                        <p class="day">18</p>
                        <p class="day">19</p>
                        <p class="day">20</p>
                        <p class="day">21</p>
                        <p class="day">22</p>
                        <p class="day">23</p>
                        <p class="day">24</p>
                        <p class="day">25</p>
                        <p class="day">26</p>
                        <p class="day">27</p>
                        <p class="day">28</p>
                        <p class="day">29</p>
                        <p style="border-right: none" class="day">30</p>
                        {/if}
                        {if condition="in_array($presentMonth,[2]) and $presentYear%4!==0"}
                        <p class="day">01</p>
                        <p class="day">02</p>
                        <p class="day">03</p>
                        <p class="day">04</p>
                        <p class="day">05</p>
                        <p class="day">06</p>
                        <p class="day">07</p>
                        <p class="day">08</p>
                        <p class="day">09</p>
                        <p class="day">10</p>
                        <p class="day">11</p>
                        <p class="day">12</p>
                        <p class="day">13</p>
                        <p class="day">14</p>
                        <p class="day">15</p>
                        <p class="day">16</p>
                        <p class="day">17</p>
                        <p class="day">18</p>
                        <p class="day">19</p>
                        <p class="day">20</p>
                        <p class="day">21</p>
                        <p class="day">22</p>
                        <p class="day">23</p>
                        <p class="day">24</p>
                        <p class="day">25</p>
                        <p class="day">26</p>
                        <p class="day">27</p>
                        <p style="border-right: none" class="day">28</p>
                        {/if}
                        {if condition="in_array($presentMonth,[2]) and $presentYear%4==0"}
                        <p class="day">01</p>
                        <p class="day">02</p>
                        <p class="day">03</p>
                        <p class="day">04</p>
                        <p class="day">05</p>
                        <p class="day">06</p>
                        <p class="day">07</p>
                        <p class="day">08</p>
                        <p class="day">09</p>
                        <p class="day">10</p>
                        <p class="day">11</p>
                        <p class="day">12</p>
                        <p class="day">13</p>
                        <p class="day">14</p>
                        <p class="day">15</p>
                        <p class="day">16</p>
                        <p class="day">17</p>
                        <p class="day">18</p>
                        <p class="day">19</p>
                        <p class="day">20</p>
                        <p class="day">21</p>
                        <p class="day">22</p>
                        <p class="day">23</p>
                        <p class="day">24</p>
                        <p class="day">25</p>
                        <p class="day">26</p>
                        <p class="day">27</p>
                        <p class="day">28</p>
                        <p style="border-right: none" class="day">29</p>
                        {/if}
                    </div>
                    <div class="week-box">
                        {if condition="in_array($presentMonth,[1,3,5,7,8,10,12])"}
                        <p class="week">01</p>
                        <p class="week">02</p>
                        <p class="week">03</p>
                        <p class="week">04</p>
                        <p class="week">05</p>
                        <p class="week">06</p>
                        <p class="week">07</p>
                        <p class="week">08</p>
                        <p class="week">09</p>
                        <p class="week">10</p>
                        <p class="week">11</p>
                        <p class="week">12</p>
                        <p class="week">13</p>
                        <p class="week">14</p>
                        <p class="week">15</p>
                        <p class="week">16</p>
                        <p class="week">17</p>
                        <p class="week">18</p>
                        <p class="week">19</p>
                        <p class="week">20</p>
                        <p class="week">21</p>
                        <p class="week">22</p>
                        <p class="week">23</p>
                        <p class="week">24</p>
                        <p class="week">25</p>
                        <p class="week">26</p>
                        <p class="week">27</p>
                        <p class="week">28</p>
                        <p class="week">29</p>
                        <p class="week">30</p>
                        <p style="border-right: none" class="week">31</p>
                        {/if}
                        {if condition="in_array($presentMonth,[4,6,9,11])"}
                        <p class="week">01</p>
                        <p class="week">02</p>
                        <p class="week">03</p>
                        <p class="week">04</p>
                        <p class="week">05</p>
                        <p class="week">06</p>
                        <p class="week">07</p>
                        <p class="week">08</p>
                        <p class="week">09</p>
                        <p class="week">10</p>
                        <p class="week">11</p>
                        <p class="week">12</p>
                        <p class="week">13</p>
                        <p class="week">14</p>
                        <p class="week">15</p>
                        <p class="week">16</p>
                        <p class="week">17</p>
                        <p class="week">18</p>
                        <p class="week">19</p>
                        <p class="week">20</p>
                        <p class="week">21</p>
                        <p class="week">22</p>
                        <p class="week">23</p>
                        <p class="week">24</p>
                        <p class="week">25</p>
                        <p class="week">26</p>
                        <p class="week">27</p>
                        <p class="week">28</p>
                        <p class="week">29</p>
                        <p style="border-right: none" class="week">30</p>
                        {/if}
                        {if condition="in_array($presentMonth,[2]) and $presentYear%4!==0"}
                        <p class="week">01</p>
                        <p class="week">02</p>
                        <p class="week">03</p>
                        <p class="week">04</p>
                        <p class="week">05</p>
                        <p class="week">06</p>
                        <p class="week">07</p>
                        <p class="week">08</p>
                        <p class="week">09</p>
                        <p class="week">10</p>
                        <p class="week">11</p>
                        <p class="week">12</p>
                        <p class="week">13</p>
                        <p class="week">14</p>
                        <p class="week">15</p>
                        <p class="week">16</p>
                        <p class="week">17</p>
                        <p class="week">18</p>
                        <p class="week">19</p>
                        <p class="week">20</p>
                        <p class="week">21</p>
                        <p class="week">22</p>
                        <p class="week">23</p>
                        <p class="week">24</p>
                        <p class="week">25</p>
                        <p class="week">26</p>
                        <p class="week">27</p>
                        <p style="border-right: none" class="week">28</p>
                        {/if}
                        {if condition="in_array($presentMonth,[2]) and $presentYear%4==0"}
                        <p class="week">01</p>
                        <p class="week">02</p>
                        <p class="week">03</p>
                        <p class="week">04</p>
                        <p class="week">05</p>
                        <p class="week">06</p>
                        <p class="week">07</p>
                        <p class="week">08</p>
                        <p class="week">09</p>
                        <p class="week">10</p>
                        <p class="week">11</p>
                        <p class="week">12</p>
                        <p class="week">13</p>
                        <p class="week">14</p>
                        <p class="week">15</p>
                        <p class="week">16</p>
                        <p class="week">17</p>
                        <p class="week">18</p>
                        <p class="week">19</p>
                        <p class="week">20</p>
                        <p class="week">21</p>
                        <p class="week">22</p>
                        <p class="week">23</p>
                        <p class="week">24</p>
                        <p class="week">25</p>
                        <p class="week">26</p>
                        <p class="week">27</p>
                        <p class="week">28</p>
                        <p style="border-right: none" class="week">29</p>
                        {/if}
                    </div>
                </div>
                <div class="process-box">
                    {if condition="in_array($presentMonth,[1,3,5,7,8,10,12])"}
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p style="border-right:none;" class="td"></p>
                    {/if}
                    {if condition="in_array($presentMonth,[4,6,9,11])"}
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    {/if}
                    {if condition="in_array($presentMonth,[2]) and $presentYear%4!==0"}
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    {/if}
                    {if condition="in_array($presentMonth,[2]) and $presentYear%4==0"}
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    <p class="td"></p>
                    {/if}

                </div>
                <div class="line"></div>
                <div class="time-outbox">
                    {foreach name="v['duty']" item='vo'}
                    {if condition="$vo['startdate']==''"}
                    {if condition="$vo['zycd']==1"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="time-box important-unfinish">
                    </div>
                    {else /}
                    <div class="time-box important-finish">
                    </div>
                    {/if}
                    {/if}
                    {if condition="$vo['zycd']==0"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="time-box usual-unfinish">
                    </div>
                    {else /}
                    <div class="time-box usual-finish">
                    </div>
                    {/if}
                    {/if}
                    {else /}
                    {if condition="$vo['zycd']==1"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="time-box important-unfinish">
                        {if condition="($vo['rwjd']==1) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time green">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:ltrim(strrchr($vo['enddate'],'-'),'-')}">
                            <div class="time-right"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==0) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time pink">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==1) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time orange">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==2) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time yellow">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time blue">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                    </div>
                    {else /}
                    <div class="time-box important-finish">
                        {if condition="($vo['rwjd']==1) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time green">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:ltrim(strrchr($vo['enddate'],'-'),'-')}">
                            <div class="time-right"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==0) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time pink">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==1) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time orange">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==2) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time yellow">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time blue">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                    </div>
                    {/if}
                    {/if}
                    {if condition="$vo['zycd']==0"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="time-box usual-unfinish">
                        {if condition="($vo['rwjd']==1) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time green">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:ltrim(strrchr($vo['enddate'],'-'),'-')}">
                            <div class="time-right"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==0) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time pink">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==1) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time orange">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==2) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time yellow">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time blue">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                    </div>
                    {else /}
                    <div class="time-box usual-finish">
                        {if condition="($vo['rwjd']!==1) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time green">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:ltrim(strrchr($vo['enddate'],'-'),'-')}">
                            <div class="time-right"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==0) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time pink">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==1) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time orange">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['zycd']==2) and (!$vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time yellow">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['ahead']) and (ltrim(strrchr($vo['startdate'],'-'),'-')) and (ltrim(strrchr($vo['enddate'],'-'),'-'))"}
                        <div class="time blue">
                            <input type="hidden" name="id" value="{$vo['id']}">
                            <input type="hidden" name="startdate" value="{:date('d',strtotime($vo['startdate']))}">
                            <input type="hidden" name="enddate" value="{:date('d',strtotime($vo['enddate']))}">
                            <div class="time-right"></div>
                            <div class="time-left"></div>
                        </div>
                        {/if}
                    </div>
                    {/if}
                    {/if}
                    {/if}
                    {/foreach}
                </div>

            </div>
            <div class="status">
                <div class="status-header">
                    <div class="status-every-header-text">未完成任务</div>
                    <select class="status-every-header-select">
                        <option value="0" {if condition="$v['dutyfinish']==0"} selected {/if}>未完成任务</option>
                        <option value="1" {if condition="$v['dutyfinish']==1"} selected {/if}>已完成任务</option>
                        <option value="2" {if condition="$v['dutyfinish']==2"} selected {/if}>全部任务</option>
                    </select>
                </div>
                <div class="status-box">
                    {foreach name="v['duty']" item='vo'}
                    {if condition="$vo['zycd']==1"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="status-every important-unfinish">
                        {if condition="$vo['rwjd']==1"}
                        已完成
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']!=='')"}
                        <a class="btn">未完成</a>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']=='')"}
                        未完成
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']!=='') and (!$vo['well'])"}
                        未完成
                        {/if}
                    </div>
                    {else /}
                    <div class="status-every important-finish">
                        {if condition="$vo['rwjd']==1"}
                        已完成
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']!=='')"}
                        <a class="btn">未完成</a>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']=='')"}
                        未完成
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']!=='') and (!$vo['well'])"}
                        未完成
                        {/if}
                    </div>
                    {/if}
                    {/if}
                    {if condition="$vo['zycd']==0"}
                    {if condition="$vo['rwjd']!==1"}
                    <div class="status-every usual-unfinish">
                        {if condition="$vo['rwjd']==1"}
                        已完成
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']!=='')"}
                        <a class="btn">未完成</a>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']=='')"}
                        未完成
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']!=='') and (!$vo['well'])"}
                        未完成
                        {/if}
                    </div>
                    {else /}
                    <div class="status-every usual-finish">
                        {if condition="$vo['rwjd']==1"}
                        已完成
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']!=='')"}
                        <a class="btn">未完成</a>
                        {/if}
                        {if condition="($vo['rwjd']!==1) and ($vo['startdate']=='')"}
                        未完成
                        {/if}
                    </div>
                    {/if}
                    {/if}
                    {/foreach}
                </div>
            </div>
        </li>
        {/foreach}
    </ul>
    <!--表格主体区域结束-->
    <!-- 楼层按钮-->
    <a class="lou-btn" href="javascript:;">
        选择员工
    </a>
    <div class="lou-box">
        {foreach name='data' item='v'}
        <a class="lou" href="javascript:;">
            {$v['name']}
        </a>
        {/foreach}
    </div>
    <!-- 楼层按钮结束-->
</div>
</body>
</html>